<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ตรวจสอบประเภทโทรศัพท์</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding: 20px; background:#f7fafc; color:#0f172a; }
    .card { background: white; border-radius: 12px; box-shadow: 0 6px 18px rgba(2,6,23,0.08); padding: 18px; max-width: 800px; margin: 12px auto; }
    h1 { font-size: 20px; margin: 0 0 8px 0; }
    p.lead { margin: 0 0 16px 0; color: #475569; }
    button { background:#0369a1; color:white; border:0; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600; }
    button.secondary { background:#e2e8f0; color:#0f172a; margin-left:8px; }
    pre { background:#0b1220; color:#e6eef8; padding:12px; border-radius:8px; overflow:auto; font-size:13px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; }
    td{ padding:8px 6px; border-top:1px solid #eef2f7; vertical-align:top; }
    .key{ width:32%; color:#334155; font-weight:600; }
    .value{ color:#0f172a; word-break:break-word; }
    .small { font-size:13px; color:#64748b; margin-top:8px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ตรวจสอบประเภทโทรศัพท์ (Device Detector)</h1>
    <p class="lead">กดปุ่มเพื่อดึงข้อมูลที่เบราว์เซอร์ส่งมา — จะบอกว่ากำลังใช้มือถือหรือเดสก์ท็อป, ระบบปฏิบัติการ และความเป็นไปได้ของรุ่นโทรศัพท์</p>

    <div>
      <button id="detectBtn">ตรวจสอบอุปกรณ์ตอนนี้</button>
      <button id="copyBtn" class="secondary">คัดลอกเป็นข้อความ</button>
    </div>

    <div id="result" style="margin-top:14px; display:none;">
      <table>
        <tr><td class="key">ประเภทอุปกรณ์</td><td class="value" id="deviceType"></td></tr>
        <tr><td class="key">ระบบปฏิบัติการ</td><td class="value" id="os"></td></tr>
        <tr><td class="key">ยี่ห้อ/รุ่น (หากมี)</td><td class="value" id="model"></td></tr>
        <tr><td class="key">User Agent</td><td class="value"><small id="ua"></small></td></tr>
        <tr><td class="key">Client Hints</td><td class="value"><small id="clientHints"></small></td></tr>
        <tr><td class="key">ขนาดหน้าจอ</td><td class="value" id="screen"></td></tr>
        <tr><td class="key">สัมผัส / Touch</td><td class="value" id="touch"></td></tr>
      </table>

      <div class="small">
        หมายเหตุ: เบราว์เซอร์บางตัว/เวอร์ชันปกป้องข้อมูล make/model จึงอาจไม่สามารถเห็นรุ่นจริงได้เสมอไป
      </div>
      <pre id="rawJson" style="margin-top:12px; display:none;"></pre>
    </div>
  </div>

<script>
async function detectDevice() {
  const out = {};
  // 기본 정보: userAgent และ platform
  out.userAgent = navigator.userAgent || "ไม่พบ userAgent";
  out.platform = navigator.platform || "ไม่ระบุ";
  out.screen = {
    width: window.screen.width,
    height: window.screen.height,
    innerWidth: window.innerWidth,
    innerHeight: window.innerHeight,
    devicePixelRatio: window.devicePixelRatio || 1
  };
  out.touchSupported = (('ontouchstart' in window) || navigator.maxTouchPoints > 0);

  // พยายามใช้ User-Agent Client Hints ถ้ามี
  out.hints = {};
  if (navigator.userAgentData && typeof navigator.userAgentData.getHighEntropyValues === 'function') {
    try {
      const high = await navigator.userAgentData.getHighEntropyValues(['platform','platformVersion','brands','model','mobile','uaFullVersion']);
      out.hints = high;
    } catch (e) {
      out.hintsError = e.toString();
    }
  } else {
    out.hints = null;
  }

  // วิเคราะห์จาก userAgent แบบง่าย (fallback)
  const ua = out.userAgent.toLowerCase();

  // deviceType
  if (/mobile|iphone|ipod|android.*mobile|windows phone/.test(ua) || (out.hints && out.hints.mobile === true)) {
    out.deviceType = 'มือถือ (Mobile)';
  } else if (/tablet|ipad|android(?!.*mobile)/.test(ua)) {
    out.deviceType = 'แท็บเล็ต (Tablet)';
  } else {
    out.deviceType = 'เดสก์ท็อป / ไม่ทราบ (Desktop/Other)';
  }

  // os detection
  let os = 'ไม่ทราบ';
  if (/iphone|ipad|ipod|mac os x/i.test(ua) || (out.hints && /ios|mac os/.test((out.hints.platform||'').toLowerCase()))) {
    if (/android/i.test(ua)) { /* unlikely */ }
    if (/iphone|ipad|ipod/i.test(ua) || (out.hints && (out.hints.platform || '').toLowerCase().includes('ios'))) os = 'iOS / iPadOS';
    else if (/mac os x/i.test(ua) || (out.hints && (out.hints.platform || '').toLowerCase().includes('mac'))) os = 'macOS / iPadOS';
  }
  if (/android/i.test(ua) || (out.hints && (out.hints.platform || '').toLowerCase().includes('android'))) {
    os = 'Android';
  }
  if (/windows phone|windows nt/i.test(ua)) os = 'Windows';
  if (/linux/i.test(ua) && !/android/i.test(ua)) os = 'Linux';

  out.os = os;

  // model detection: ถ้ามี client hints model ให้ใช้, ถ้าไม่มาลอง parse จาก ua
  let model = null;
  if (out.hints && out.hints.model) model = out.hints.model;
  // common patterns from userAgent (best-effort)
  if (!model) {
    // iPhone: look for "iPhone" and possible like "iPhone12,3" or "iPhone OS 14_2"
    const matchI = out.userAgent.match(/\b(iPhone|iPad|iPod)\b/i);
    if (matchI) model = matchI[0];
    else {
      // Android common markers: "SM-G991B" (Samsung), "Pixel 6", "HUAWEI", "Mi" etc
      const androidModel = out.userAgent.match(/\b(SM-[A-Z0-9]+|Pixel\s?[0-9A-Za-z\-]+|HUAWEI|HONOR|M10|Mi[\s\-]?[0-9]+|Redmi|Vivo|OPPO|Poco|Realme)[\/\s\-]?[0-9A-Za-z]*\b/i);
      if (androidModel) model = androidModel[0];
    }
  }
  if (!model) model = 'ไม่สามารถระบุรุ่นได้ (ข้อมูลจำกัด)';

  // userAgentData.brands (optional)
  let brands = null;
  if (navigator.userAgentData && navigator.userAgentData.brands) {
    brands = navigator.userAgentData.brands.map(b=> b.brand + ' v' + b.version).join(' | ');
  }

  return {
    deviceType: out.deviceType,
    os: out.os,
    model,
    userAgent: out.userAgent,
    clientHints: out.hints,
    brands,
    screen: out.screen,
    touchSupported: out.touchSupported,
    raw: out
  };
}

const detectBtn = document.getElementById('detectBtn');
const copyBtn = document.getElementById('copyBtn');
const resultEl = document.getElementById('result');
const deviceTypeEl = document.getElementById('deviceType');
const osEl = document.getElementById('os');
const modelEl = document.getElementById('model');
const uaEl = document.getElementById('ua');
const clientHintsEl = document.getElementById('clientHints');
const screenEl = document.getElementById('screen');
const touchEl = document.getElementById('touch');
const rawJsonEl = document.getElementById('rawJson');

detectBtn.addEventListener('click', async () => {
  detectBtn.disabled = true;
  detectBtn.textContent = 'กำลังตรวจสอบ...';
  try {
    const info = await detectDevice();
    deviceTypeEl.textContent = info.deviceType;
    osEl.textContent = info.os;
    modelEl.textContent = info.model;
    uaEl.textContent = info.userAgent;
    clientHintsEl.textContent = info.brands ? info.brands + (info.clientHints ? ' | has high-entropy' : '') : JSON.stringify(info.clientHints || {});
    screenEl.textContent = `${info.screen.width}×${info.screen.height} (inner ${info.screen.innerWidth}×${info.screen.innerHeight}) DPR ${info.screen.devicePixelRatio}`;
    touchEl.textContent = info.touchSupported ? 'รองรับการสัมผัส (touch supported)' : 'ไม่รองรับสัมผัส';
    rawJsonEl.style.display = 'block';
    rawJsonEl.textContent = JSON.stringify(info.clientHints ? info : info, null, 2);
    resultEl.style.display = 'block';
  } catch (e) {
    alert('เกิดข้อผิดพลาด: ' + e);
  } finally {
    detectBtn.disabled = false;
    detectBtn.textContent = 'ตรวจสอบอุปกรณ์ตอนนี้';
  }
});

copyBtn.addEventListener('click', () => {
  const lines = [];
  if (resultEl.style.display === 'none') {
    alert('ยังไม่มีผลลัพธ์ — กรุณากดปุ่ม "ตรวจสอบอุปกรณ์ตอนนี้" ก่อน');
    return;
  }
  lines.push('ประเภทอุปกรณ์: ' + deviceTypeEl.textContent);
  lines.push('ระบบปฏิบัติการ: ' + osEl.textContent);
  lines.push('ยี่ห้อ/รุ่น: ' + modelEl.textContent);
  lines.push('ขนาดหน้าจอ: ' + screenEl.textContent);
  lines.push('User Agent: ' + uaEl.textContent);
  lines.push('Client Hints: ' + clientHintsEl.textContent);
  const txt = lines.join('\n');
  navigator.clipboard?.writeText(txt).then(() => {
    copyBtn.textContent = 'คัดลอกแล้ว ✓';
    setTimeout(()=> copyBtn.textContent = 'คัดลอกเป็นข้อความ', 1500);
  }).catch(()=> {
    alert('ไม่สามารถคัดลอกอัตโนมัติได้ — กรุณาคัดลอกด้วยตนเอง:\n\n' + txt);
  });
});

// Optional: auto-run whenโหลดหน้า (ถ้าต้องการ ให้ uncomment)
// window.addEventListener('load', () => detectBtn.click());
</script>
</body>
</html>
