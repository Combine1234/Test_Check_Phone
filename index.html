<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Device Detector + GPS</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding: 20px; background:#f7fafc; color:#0f172a; }
    .card { background: white; border-radius: 12px; box-shadow: 0 6px 18px rgba(2,6,23,0.08); padding: 18px; max-width: 900px; margin: 12px auto; }
    h1 { font-size: 22px; margin: 0 0 8px 0; }
    p.lead { margin: 0 0 16px 0; color: #475569; }
    button { background:#0369a1; color:white; border:0; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:600; }
    button.secondary { background:#e2e8f0; color:#0f172a; margin-left:8px; }
    pre { background:#0b1220; color:#e6eef8; padding:12px; border-radius:8px; overflow:auto; font-size:13px; }
    table { width:100%; border-collapse:collapse; margin-top:12px; }
    td{ padding:8px 6px; border-top:1px solid #eef2f7; vertical-align:top; }
    .key{ width:32%; color:#334155; font-weight:600; }
    .value{ color:#0f172a; word-break:break-word; }
    .small { font-size:13px; color:#64748b; margin-top:8px; }
    .gps-box { margin-top:18px; padding-top:14px; border-top:2px dashed #cbd5e1; }
  </style>
</head>
<body>

<!-- ==================== Device Detector ==================== -->
  <div class="card">
    <h1>ตรวจสอบประเภทโทรศัพท์ (Device Detector)</h1>
    <p class="lead">กดปุ่มเพื่อดึงข้อมูลที่เบราว์เซอร์ส่งมา — จะบอกว่ากำลังใช้มือถือหรือเดสก์ท็อป, ระบบปฏิบัติการ และความเป็นไปได้ของรุ่นโทรศัพท์</p>

    <div>
      <button id="detectBtn">ตรวจสอบอุปกรณ์ตอนนี้</button>
      <button id="copyBtn" class="secondary">คัดลอกเป็นข้อความ</button>
    </div>

    <div id="result" style="margin-top:14px; display:none;">
      <table>
        <tr><td class="key">ประเภทอุปกรณ์</td><td class="value" id="deviceType"></td></tr>
        <tr><td class="key">ระบบปฏิบัติการ</td><td class="value" id="os"></td></tr>
        <tr><td class="key">ยี่ห้อ/รุ่น (หากมี)</td><td class="value" id="model"></td></tr>
        <tr><td class="key">User Agent</td><td class="value"><small id="ua"></small></td></tr>
        <tr><td class="key">Client Hints</td><td class="value"><small id="clientHints"></small></td></tr>
        <tr><td class="key">ขนาดหน้าจอ</td><td class="value" id="screen"></td></tr>
        <tr><td class="key">สัมผัส / Touch</td><td class="value" id="touch"></td></tr>
      </table>

      <div class="small">
        หมายเหตุ: เบราว์เซอร์บางตัว/เวอร์ชันปกป้องข้อมูล make/model จึงอาจไม่สามารถเห็นรุ่นจริงได้เสมอไป
      </div>
      <pre id="rawJson" style="margin-top:12px; display:none;"></pre>
    </div>

    <!-- ==================== GPS Section ==================== -->
    <div class="gps-box">
      <h1>ตรวจสอบตำแหน่ง GPS</h1>
      <p class="lead">กดปุ่มเพื่อดึงพิกัดปัจจุบันจากอุปกรณ์</p>
      <button id="gpsBtn">ดึงตำแหน่ง GPS</button>

      <div id="gpsResult" style="display:none; margin-top:14px;">
        <table>
          <tr><td class="key">Latitude</td><td class="value" id="gpsLat"></td></tr>
          <tr><td class="key">Longitude</td><td class="value" id="gpsLon"></td></tr>
          <tr><td class="key">Accuracy</td><td class="value" id="gpsAcc"></td></tr>
        </table>
      </div>
    </div>

  </div>

<!-- ==================== SCRIPT ==================== -->
<script>
/* ==========================
   DEVICE DETECTOR (ของคุณ)
========================== */
async function detectDevice() {
  const out = {};
  out.userAgent = navigator.userAgent || "ไม่พบ userAgent";
  out.platform = navigator.platform || "ไม่ระบุ";
  out.screen = {
    width: window.screen.width,
    height: window.screen.height,
    innerWidth: window.innerWidth,
    innerHeight: window.innerHeight,
    devicePixelRatio: window.devicePixelRatio || 1
  };
  out.touchSupported = (('ontouchstart' in window) || navigator.maxTouchPoints > 0);

  out.hints = {};
  if (navigator.userAgentData && navigator.userAgentData.getHighEntropyValues) {
    try {
      const high = await navigator.userAgentData.getHighEntropyValues([
        'platform','platformVersion','brands','model','mobile','uaFullVersion'
      ]);
      out.hints = high;
    } catch (e) {
      out.hintsError = e.toString();
    }
  } else out.hints = null;

  const ua = out.userAgent.toLowerCase();

  if (/mobile|iphone|android.*mobile/.test(ua) || (out.hints && out.hints.mobile))
    out.deviceType = 'มือถือ (Mobile)';
  else if (/tablet|ipad/.test(ua))
    out.deviceType = 'แท็บเล็ต (Tablet)';
  else
    out.deviceType = 'เดสก์ท็อป / ไม่ทราบ (Desktop/Other)';

  let os = 'ไม่ทราบ';
  if (/android/.test(ua)) os = 'Android';
  else if (/iphone|ipad|ipod/.test(ua)) os = 'iOS / iPadOS';
  else if (/mac os/.test(ua)) os = 'macOS';
  else if (/windows/.test(ua)) os = 'Windows';
  else if (/linux/.test(ua)) os = 'Linux';
  out.os = os;

  let model = null;
  if (out.hints && out.hints.model) model = out.hints.model;
  if (!model) {
    const m1 = out.userAgent.match(/\b(SM-[A-Z0-9]+|Pixel\s?[0-9A-Za-z\-]+|iPhone|iPad|iPod|OPPO|Vivo|Realme|Poco|Redmi)\b/i);
    if (m1) model = m1[0];
  }
  if (!model) model = "ไม่สามารถระบุรุ่นได้ (ข้อมูลจำกัด)";

  let brands = null;
  if (navigator.userAgentData && navigator.userAgentData.brands)
    brands = navigator.userAgentData.brands.map(b => b.brand + " v" + b.version).join(" | ");

  return {
    deviceType: out.deviceType,
    os: out.os,
    model,
    userAgent: out.userAgent,
    clientHints: out.hints,
    brands,
    screen: out.screen,
    touchSupported: out.touchSupported,
    raw: out
  };
}

const detectBtn = document.getElementById('detectBtn');
const copyBtn = document.getElementById('copyBtn');
const resultEl = document.getElementById('result');
const deviceTypeEl = document.getElementById('deviceType');
const osEl = document.getElementById('os');
const modelEl = document.getElementById('model');
const uaEl = document.getElementById('ua');
const clientHintsEl = document.getElementById('clientHints');
const screenEl = document.getElementById('screen');
const touchEl = document.getElementById('touch');
const rawJsonEl = document.getElementById('rawJson');

detectBtn.addEventListener('click', async () => {
  detectBtn.disabled = true;
  detectBtn.textContent = 'กำลังตรวจสอบ...';

  try {
    const info = await detectDevice();
    deviceTypeEl.textContent = info.deviceType;
    osEl.textContent = info.os;
    modelEl.textContent = info.model;
    uaEl.textContent = info.userAgent;
    clientHintsEl.textContent = info.brands 
      ? info.brands + (info.clientHints ? ' | has high-entropy' : '')
      : JSON.stringify(info.clientHints || {});
    screenEl.textContent =
      `${info.screen.width}×${info.screen.height} (inner ${info.screen.innerWidth}×${info.screen.innerHeight}) DPR ${info.screen.devicePixelRatio}`;
    touchEl.textContent = info.touchSupported ? 'รองรับการสัมผัส' : 'ไม่รองรับการสัมผัส';

    rawJsonEl.style.display = 'block';
    rawJsonEl.textContent = JSON.stringify(info, null, 2);
    resultEl.style.display = 'block';
  } catch (e) {
    alert("เกิดข้อผิดพลาด: " + e);
  }

  detectBtn.disabled = false;
  detectBtn.textContent = 'ตรวจสอบอุปกรณ์ตอนนี้';
});

/* ================ COPY ================ */
copyBtn.addEventListener('click', () => {
  if (resultEl.style.display === 'none') {
    alert('ยังไม่มีผลลัพธ์ — กรุณากด "ตรวจสอบอุปกรณ์ตอนนี้"');
    return;
  }

  const txt =
    `ประเภทอุปกรณ์: ${deviceTypeEl.textContent}\n` +
    `ระบบปฏิบัติการ: ${osEl.textContent}\n` +
    `รุ่น: ${modelEl.textContent}\n` +
    `ขนาดหน้าจอ: ${screenEl.textContent}\n` +
    `User Agent: ${uaEl.textContent}\n` +
    `Client Hints: ${clientHintsEl.textContent}`;

  navigator.clipboard.writeText(txt).then(() => {
    copyBtn.textContent = 'คัดลอกแล้ว ✓';
    setTimeout(() => copyBtn.textContent = 'คัดลอกเป็นข้อความ', 1500);
  });
});

/* ==========================
   GPS SECTION (ของผม)
========================== */
const gpsBtn = document.getElementById("gpsBtn");
const gpsResult = document.getElementById("gpsResult");
const gpsLat = document.getElementById("gpsLat");
const gpsLon = document.getElementById("gpsLon");
const gpsAcc = document.getElementById("gpsAcc");

gpsBtn.addEventListener("click", () => {
  if (!navigator.geolocation) {
    alert("เบราว์เซอร์นี้ไม่รองรับ GPS");
    return;
  }

  gpsBtn.disabled = true;
  gpsBtn.textContent = "กำลังดึงพิกัด...";

  navigator.geolocation.getCurrentPosition(
    (pos) => {
      gpsLat.textContent = pos.coords.latitude;
      gpsLon.textContent = pos.coords.longitude;
      gpsAcc.textContent = pos.coords.accuracy + " m";

      gpsResult.style.display = "block";
      gpsBtn.disabled = false;
      gpsBtn.textContent = "ดึงตำแหน่ง GPS";
    },
    (err) => {
      alert("ไม่สามารถดึงตำแหน่งได้: " + err.message);
      gpsBtn.disabled = false;
      gpsBtn.textContent = "ดึงตำแหน่ง GPS";
    },
    {
      enableHighAccuracy: true,
      timeout: 10000,
      maximumAge: 0
    }
  );
});
</script>
</body>
</html>
